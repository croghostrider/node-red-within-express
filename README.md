# node-red-within-express #

This repository contains an HTTP server based on [Node.js](https://nodejs.org/en/) with [Express.js](http://expressjs.com/) with an embedded [Node-RED](https://nodered.org/) instance.

Its intended purpose is to provide a very easily maintainable server for development and test of web and REST service prototypes.

## Features ##

The implemented server offers the following features:

* **HTTPS with optional HTTP-to-HTTPS Redirection**<br>the main server handles HTTPS only as it becomes more and more difficult to serve HTTP-only content (even locally). If desired, an additional auxiliary HTTP server may be started which redirects incoming requests to its HTTPS counterpart
* **Support for "self-signed" or "Let's Encrypt" Certificates**<br>for local tests, it may be sufficient to generate self-signed certificates (instructions are included). For public tests, the server supports certificates generated by ["Let's Encrypt"](https://letsencrypt.org/)
* **embedded Node-RED runtime**
  * incoming requests will first be compared to the entry points given by "HTTP in" nodes - and their flows be executed if the URL paths match
  * requests not matching any "HTTP in" node entry points will then be used to serve static files from the file system (or generate a 404 response if no matching file could be found)
* **embedded Node-RED editor**<br>the Node-RED editor is available as well, but protected by "basic HTTP authentication": initially, the server comes with a "User Registry" containing a single user (called "node-red" with the initial password "t0pS3cr3t!") who is the only one allowed to access the Node-RED editor
* **User Registry with PBKDF2 hashed passwords and Role Support**<br>the list of registered users is stored in a JSON file. Passwords are not stored as plain text but PBKDF2 hashes with random salt. While the server does not contain any kind of user management, a simple text editor is sufficient to add new users, change existing ones or remove obsolete users
* **Path-specific CORS**<br>"Cross-Origin Resource Sharing" may be configured for whole sites or specific resource paths at any desired granularity
* **standard-comliant Logging**<br>access logging is done using [morgan](https://expressjs.com/en/resources/middleware/morgan.html) and may be written into a file in "standard Apache common log format"

## Installation and Use ##

### Preparing the first Start ###

### First Experiments ###

## Invocation Parameters ##

### Configuring Domains and Virtual Hosts ###

## Embedded Node-RED Instance ##

## User registry ##

### Generating "Salt" and "Hash" ###

## CORS Support ##

## Content Security Polcies ##

## Logging ##



* HTTPS (and auto-redirection from HTTP to HTTPS) with self-signed or "Let's Encrypt" Certificates
* virtual Hosts
  * how to configure Domains in /etc/hosts
  * Subdomains
* User Registry
  * Basic Auth and PBKDF2
  * adding Users to the Registry
  * protecting the Node-RED Editor
* CORS Support
* initial Node-RED Flows
* Postman Collection for Tests

